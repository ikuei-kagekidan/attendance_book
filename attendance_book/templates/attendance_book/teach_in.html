<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    
    {% load static %}
    <script src="{% static 'attendance_book/jquery-3.6.0.min.js' %}"></script>
    <script>
        $(function () {
            $("#HR-button").on("click", () => {
                $("#timetable-dialog").show("slow")
            });
            $("#timetable-dialog-close").on("click", () => {
                $("#timetable-dialog").hide("slow");
            });
            const at_json = {{ attendance_status | safe }};
            for (const key in at_json) {
                for (let i=0; i<9; i++) {
                    if (at_json[key][i] == 0) {
                        let css_selector = "#" + key + "-" + String(i)
                        $(css_selector).text("a");
                    }
                }
            }
        });
    </script>
    <style>
        #timetable-dialog {
            display: none;
        }
        #hidden-date-input {
            display: none;
        }
    </style>
</head>
<body>
    <p id="msg">msg</p>
    <p>{{ d|date:'Y-m-d' }}</p>
    <p>{{ d|date:"w"|add:"-1" }}</p>
    <table border="1">
        <tr>
            <th colspan="3">
                <form action="{% url 'attendance_book:teacher-input-post' %}" method="post">
                    {% csrf_token %}
                    <input id="date-input" type="date" name="date" value="{{ d|date:'Y-m-d' }}">
                    <input type="submit" name="search-date" value="検索">
                </form>
            </th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
        </tr>
        <tr>
            <th>番号</th>
            <th>名前</th>
            <th><button id="HR-button">HR</button></th>
            <th><button>1</button></th>
            <th><button>2</button></th>
            <th><button>3</button></th>
            <th><button>4</button></th>
            <th><button>5</button></th>
            <th><button>6</button></th>
            <th><button>7</button></th>
            <th><button>8</button></th>
        </tr>
        {% for student in student_list %}
        <tr id="student-{{ student.class_num }}">
            <td>{{ student.class_num }}</td>
            <td>{{ student.person.name }}</td>
            <td id="{{ student.student_num }}-{{ 0 }}"></td>
            <td id="{{ student.student_num }}-{{ 1 }}"></td>
            <td id="{{ student.student_num }}-{{ 2 }}"></td>
            <td id="{{ student.student_num }}-{{ 3 }}"></td>
            <td id="{{ student.student_num }}-{{ 4 }}"></td>
            <td id="{{ student.student_num }}-{{ 5 }}"></td>
            <td id="{{ student.student_num }}-{{ 6 }}"></td>
            <td id="{{ student.student_num }}-{{ 7 }}"></td>
            <td id="{{ student.student_num }}-{{ 8 }}"></td>
        </tr>
        {% endfor %}
    </table>
    
    <div id="timetable-dialog">
        <form action="{% url 'attendance_book:teacher-input-post' %}" method="post">
            {% csrf_token %}
            <input id="hidden-date-input" type="text" name="date" value="{{ d|date:'Y-m-d' }}" style="display:none">
            <input type="submit" name="create-timetable" value="作成">
        </form>
        <button id="timetable-dialog-close">閉じる</button>
    </div>
    
</body>
</html>